cmake_minimum_required(VERSION 3.16...3.28 FATAL_ERROR)
project(NSCA_app VERSION 0.1 LANGUAGES C CXX)

# Add NSCA prefix to CMAKE_PREFIX_PATH (already determined in root)
list(APPEND CMAKE_PREFIX_PATH "${NSCA_PREFIX}")

# Find NSCA package
find_package(NSCA REQUIRED)

# ------------------------
# Sources and headers
# ------------------------
set(APP_SRCS
    "${CMAKE_CURRENT_SOURCE_DIR}/Src/Source.cpp"
)
set(APP_HDRS
    "${CMAKE_CURRENT_SOURCE_DIR}/Include/Global_Header.h"
)

# ------------------------
# Build executable using helper
# ------------------------
App_builder(${PROJECT_NAME}
    OUTPUT_DIR           app_dir
    WIN32                ON
    EXPORT_FLAG          ""
    SOURCES              ${APP_SRCS}
    HEADERS              ${APP_HDRS}
    PUBLIC_INCLUDES      "${CMAKE_CURRENT_SOURCE_DIR}/Include"
    PRIVATE_INCLUDES     "${CMAKE_CURRENT_SOURCE_DIR}/Internal"
    LINK_LIBS            NSCA::NSCA ws2_32 
)

# ------------------------
# Deploy NSCA DLL automatically
# ------------------------
deploy_dll(NSCA "${NSCA_PREFIX}/bin" ${PROJECT_NAME})
